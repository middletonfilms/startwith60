<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Money. In Plain English. | StartWith60</title>
<meta name="description" content="Compound interest. Retirement accounts. Market performance. The knowledge rich people get from their parents — explained for everyone else.">
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white">

<div class="max-w-4xl mx-auto px-4 py-8">
  
  <!-- Back Link -->
  <div class="mb-12">
    <a href="../index.html" class="text-blue-400 hover:text-blue-300 text-sm font-semibold flex items-center">
      <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
      </svg>
      StartWith60
    </a>
  </div>

  <!-- Header -->
  <header class="mb-16 text-center">
    <h1 class="text-5xl md:text-6xl font-black mb-6 leading-tight">
      <span class="text-emerald-400">MONEY.</span><br>IN PLAIN ENGLISH.
    </h1>
    <p class="text-xl md:text-2xl text-slate-300 max-w-2xl mx-auto leading-relaxed mb-4">
      Compound interest. Retirement accounts. Market performance.
    </p>
    <p class="text-lg md:text-xl text-slate-400 max-w-2xl mx-auto">
      The knowledge rich people get from their parents — explained for everyone else.
    </p>
  </header>

  <!-- Post List -->
  <div id="post-list" class="space-y-8">
    <!-- Loading state -->
    <div class="text-center py-12">
      <div class="inline-block animate-pulse bg-slate-800 rounded-lg px-6 py-3">
        <span class="text-slate-400">Loading posts...</span>
      </div>
    </div>
  </div>

</div>

<script>
// Fetch posts from GitHub
fetch('https://api.github.com/repos/middletonfilms/startwith60/contents/blog/posts')
  .then(res => res.json())
  .then(files => {
    const mdFiles = files.filter(f => f.name.endsWith('.md'));
    
    // Fetch each post
    const postPromises = mdFiles.map(file => {
      const slug = file.name.replace('.md', '');
      return fetch(file.download_url)
        .then(res => res.text())
        .then(content => {
          // Extract title (first H1)
          const titleMatch = content.match(/^#\s+(.+)$/m);
          const title = titleMatch ? titleMatch[1] : slug;
          
          // Extract hook (look for bold text or first real paragraph)
          const lines = content.split('\n').filter(l => l.trim());
          
          // Try to find a compelling hook
          let hook = '';
          for (let line of lines) {
            // Skip title, skip short lines, skip disclaimers, skip HTML blocks
            if (line.startsWith('#')) continue;
            if (line.length < 50) continue;
            if (line.toLowerCase().includes('quick note:')) continue;
            if (line.toLowerCase().includes('disclaimer')) continue;
            if (line.includes('class="disclaimer-box"')) continue;
            if (line.includes('<div') && !hook) continue; // Skip opening div tags at start
            if (line.includes('</div>') && !hook) continue; // Skip closing div tags at start
            
            // Found a good hook
            hook = line.replace(/\*\*/g, '').replace(/\*/g, '').substring(0, 200);
            if (hook.length === 200) hook += '...';
            break;
          }
          
          // Fallback if no hook found
          if (!hook) {
            const excerptLine = lines.find(l => !l.startsWith('#') && l.length > 20);
            hook = excerptLine ? excerptLine.substring(0, 150) + '...' : '';
          }
          
          // Check if post has image reference
          const imageMatch = content.match(/!\[.*?\]\((.*?)\)/);
          const image = imageMatch ? imageMatch[1] : null;
          
          return { slug, title, hook, image };
        });
    });
    
    return Promise.all(postPromises);
  })
  .then(posts => {
    // Render posts
    const postList = document.getElementById('post-list');
    
    if (posts.length === 0) {
      postList.innerHTML = '<p class="text-center text-slate-400">No posts yet. Check back soon.</p>';
      return;
    }
    
    postList.innerHTML = posts.map(post => {
      // Determine image or gradient fallback
      let imageHTML = '';
      if (post.image) {
        // Real image
        imageHTML = `<img src="${post.image}" alt="${post.title}" class="w-full h-64 object-cover rounded-t-lg">`;
      } else {
        // Gradient placeholder with FULL title, edge-to-edge
        const colors = [
          'from-red-500 to-red-700',
          'from-blue-500 to-blue-700',
          'from-green-500 to-green-700',
          'from-purple-500 to-purple-700',
          'from-orange-500 to-orange-700'
        ];
        const colorClass = colors[Math.floor(Math.random() * colors.length)];
        
        // Calculate font size based on title length - MORE AGGRESSIVE
        let fontSize = 'text-4xl md:text-6xl';
        if (post.title.length > 80) fontSize = 'text-2xl md:text-3xl';
        else if (post.title.length > 60) fontSize = 'text-3xl md:text-4xl';
        else if (post.title.length > 40) fontSize = 'text-3xl md:text-5xl';
        else if (post.title.length < 25) fontSize = 'text-5xl md:text-7xl';
        
        imageHTML = `
          <div class="w-full h-64 bg-gradient-to-br ${colorClass} rounded-t-lg flex items-center justify-center p-3 md:p-4">
            <h3 class="text-white ${fontSize} font-black text-center leading-none break-words w-full" style="word-break: break-word; hyphens: auto; line-height: 1.1;">
              ${post.title}
            </h3>
          </div>
        `;
      }
      
      return `
        <a href="post.html?slug=${post.slug}" class="block group">
          <article class="bg-slate-800 rounded-lg overflow-hidden hover:bg-slate-750 transition-all hover:scale-[1.02] shadow-xl">
            ${imageHTML}
            
            <div class="p-6 md:p-8">
              <h2 class="text-2xl md:text-3xl font-black mb-4 leading-tight group-hover:text-blue-400 transition-colors">
                ${post.title}
              </h2>
              
              <p class="text-slate-300 text-lg mb-6 leading-relaxed">
                ${post.hook}
              </p>
              
              <div class="flex items-center justify-between">
                <span class="text-blue-400 font-bold text-lg group-hover:text-blue-300 transition-colors">
                  Read this →
                </span>
                <span class="text-slate-500 text-sm">(5 min)</span>
              </div>
            </div>
          </article>
        </a>
      `;
    }).join('');
  })
  .catch(error => {
    console.error('Error loading posts:', error);
    document.getElementById('post-list').innerHTML = `
      <div class="bg-red-900 border border-red-700 rounded-lg p-6 text-center">
        <p class="text-red-200 mb-2 font-bold">Error loading posts</p>
        <p class="text-red-300 text-sm">Make sure your GitHub repo is public or check the console for details.</p>
      </div>
    `;
  });
</script>

</body>
</html>
